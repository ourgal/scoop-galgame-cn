{
  "version": "0.1.0",
  "description": "晓之护卫～主角们的休息日～",
  "url": "https://zd.shinnku.top/file/shinnku/zd/0001-0500/%5B081225%5D%5B%E3%81%97%E3%82%83%E3%82%93%E3%81%90%E3%82%8A%E3%82%89%5D%20%E6%9A%81%E3%81%AE%E8%AD%B7%E8%A1%9B%EF%BD%9E%E3%83%97%E3%83%AA%E3%83%B3%E3%82%B7%E3%83%91%E3%83%AB%E3%81%9F%E3%81%A1%E3%81%AE%E4%BC%91%E6%97%A5%EF%BD%9E.rar",
  "hash": "9f2c7367711832564c492266bb6a06e049b02f7aa70a44d6da719cd1829c2846",
  "extract_dir": "(18禁ゲーム)[081225][しゃんぐりら]暁の護衛～プリンシパルたちの休日～ (iso+mds+rr)",
  "post_install": [
    "$sourceFilePath = \"$env:USERPROFILE\\scoop\\apps\\locale-emulator\\current\\LEProc.exe\"",
    "$chineseName = \"晓之护卫～主角们的休息日～\"",
    "$name = \"akatsuki2\"",
    "$shortcutPath1 = \"${env:APPDATA}\\Microsoft\\Windows\\Start Menu\\Programs\\Scoop Apps\\$chineseName.lnk\"",
    "$shortcutPath2 = \"${env:APPDATA}\\Microsoft\\Windows\\Start Menu\\Programs\\Scoop Apps\\$name.lnk\"",
    "$defaultSaveDir = \"$dir\\savedata\"",
    "$exe = \"晓之护卫～主角们的休息日～.exe\"",
    "$arguments = \"-run $dir\\$exe\"",
    "$icon = \"$dir\\$exe, 0\"",
    "$wScriptObj = New-Object -ComObject (\"WScript.Shell\")",
    "$shortcut = $wScriptObj.CreateShortcut($shortcutPath1)",
    "$shortcut.TargetPath = $sourceFilePath",
    "$shortcut.Arguments = $arguments",
    "$shortcut.WorkingDirectory = \"$dir\";",
    "$shortcut.WindowStyle = 1;",
    "$shortcut.IconLocation = $icon",
    "$shortcut.Save()",
    "Copy-Item \"$shortcutPath1\" -Destination \"$shortcutPath2\"",
    "$conf = \"<?xml version=\"\"1.0\"\" encoding=\"\"utf-8\"\"?>\r\n<LEConfig>\r\n  <Profiles>\r\n    <Profile Name=\"\"$exe.le.config\"\" Guid=\"\"$((New-Guid).Guid)\"\" MainMenu=\"\"false\"\">\r\n      <Parameter></Parameter>\r\n      <Location>zh</Location>\r\n      <Timezone>Tokyo Standard Time</Timezone>\r\n      <RunAsAdmin>false</RunAsAdmin>\r\n      <RedirectRegistry>true</RedirectRegistry>\r\n      <IsAdvancedRedirection>false</IsAdvancedRedirection>\r\n      <RunWithSuspend>false</RunWithSuspend>\r\n    </Profile>\r\n  </Profiles>\r\n</LEConfig>\"",
    "$galSave = if ($env:GalSave) { $env:GalSave } else { \"$env:USERPROFILE\\GalSave\" }",
    "$conf | Out-File -Encoding UTF8 \"$dir\\$exe.le.config\"",
    "mkdir $galSave\\$name >$null 2>$null",
    "if (Test-Path -Path $defaultSaveDir) { rm -force $defaultSaveDir\\* }",
    "New-Item -ItemType Junction -Path $defaultSaveDir -Target $galSave\\$name >$null"
  ],
  "depends": "extras/locale-emulator",
  "uninstaller": {
    "script": [
      "$chineseName = \"晓之护卫～主角们的休息日～\"",
      "$name = \"akatsuki2\"",
      "$shortcutPath1 = \"${env:APPDATA}\\Microsoft\\Windows\\Start Menu\\Programs\\Scoop Apps\\$chineseName.lnk\"",
      "$shortcutPath2 = \"${env:APPDATA}\\Microsoft\\Windows\\Start Menu\\Programs\\Scoop Apps\\$name.lnk\"",
      "Remove-Item -Path \"$shortcutPath1\"",
      "Remove-Item -Path \"$shortcutPath2\""
    ]
  }
}
