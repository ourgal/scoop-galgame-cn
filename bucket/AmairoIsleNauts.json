{
  "version": "0.1.0",
  "description": "天色幻想岛",
  "url": "https://zd.shinnku.top/file/shinnku/zd/0501-1000/%5B130726%5D%5B%E3%82%86%E3%81%9A%E3%82%BD%E3%83%95%E3%83%88%5D%20%E5%A4%A9%E8%89%B2%EF%BC%8A%E3%82%A2%E3%82%A4%E3%83%AB%E3%83%8E%E3%83%BC%E3%83%84.rar",
  "hash": "dd7956684f68f5ee6bdbac8a306b29706ba39b43750b6df9c36867e1cf3eee5a",
  "extract_dir": "天色幻想岛",
  "post_install": [
    "$sourceFilePath = \"$env:USERPROFILE\\scoop\\apps\\locale-emulator\\current\\LEProc.exe\"",
    "$chineseName = \"天色幻想岛\"",
    "$name = \"AmairoIsleNauts\"",
    "$shortcutPath1 = \"${env:APPDATA}\\Microsoft\\Windows\\Start Menu\\Programs\\Scoop Apps\\$chineseName.lnk\"",
    "$shortcutPath2 = \"${env:APPDATA}\\Microsoft\\Windows\\Start Menu\\Programs\\Scoop Apps\\$name.lnk\"",
    "$defaultSaveDir = \"$dir\\savedata\"",
    "$exe = \"AmairoIsleNauts_CHS.exe\"",
    "$arguments = \"-run $dir\\$exe\"",
    "$icon = \"$dir\\$exe, 0\"",
    "$wScriptObj = New-Object -ComObject (\"WScript.Shell\")",
    "$shortcut = $wScriptObj.CreateShortcut($shortcutPath1)",
    "$shortcut.TargetPath = $sourceFilePath",
    "$shortcut.Arguments = $arguments",
    "$shortcut.WorkingDirectory = \"$dir\";",
    "$shortcut.WindowStyle = 1;",
    "$shortcut.IconLocation = $icon",
    "$shortcut.Save()",
    "Copy-Item \"$shortcutPath1\" -Destination \"$shortcutPath2\"",
    "$conf = \"<?xml version=\"\"1.0\"\" encoding=\"\"utf-8\"\"?>\r\n<LEConfig>\r\n  <Profiles>\r\n    <Profile Name=\"\"$exe.le.config\"\" Guid=\"\"$((New-Guid).Guid)\"\" MainMenu=\"\"false\"\">\r\n      <Parameter></Parameter>\r\n      <Location>zh</Location>\r\n      <Timezone>Tokyo Standard Time</Timezone>\r\n      <RunAsAdmin>false</RunAsAdmin>\r\n      <RedirectRegistry>true</RedirectRegistry>\r\n      <IsAdvancedRedirection>false</IsAdvancedRedirection>\r\n      <RunWithSuspend>false</RunWithSuspend>\r\n    </Profile>\r\n  </Profiles>\r\n</LEConfig>\"",
    "$galSave = if ($env:GalSave) { $env:GalSave } else { \"$env:USERPROFILE\\GalSave\" }",
    "$conf | Out-File -Encoding UTF8 \"$dir\\$exe.le.config\"",
    "mkdir $galSave\\$name >$null 2>$null",
    "if (Test-Path -Path $defaultSaveDir) { rm -force $defaultSaveDir\\* }",
    "New-Item -ItemType Junction -Path $defaultSaveDir -Target $galSave\\$name >$null"
  ],
  "depends": "extras/locale-emulator",
  "uninstaller": {
    "script": [
      "$chineseName = \"天色幻想岛\"",
      "$name = \"AmairoIsleNauts\"",
      "$shortcutPath1 = \"${env:APPDATA}\\Microsoft\\Windows\\Start Menu\\Programs\\Scoop Apps\\$chineseName.lnk\"",
      "$shortcutPath2 = \"${env:APPDATA}\\Microsoft\\Windows\\Start Menu\\Programs\\Scoop Apps\\$name.lnk\"",
      "Remove-Item -Path \"$shortcutPath1\"",
      "Remove-Item -Path \"$shortcutPath2\""
    ]
  }
}
