{
  "version": "0.1.0",
  "description": "11月的理想乡",
  "url": "https://zd.shinnku.top/file/shinnku/0/win/11%E6%9C%88%E7%9A%84%E7%90%86%E6%83%B3%E4%B9%A1.7z",
  "hash": "97c40a52e85fd2d456d80aca7a40df599ee8495f8187c70da2e2d3d3f8a0d2be",
  "extract_dir": "11月的理想乡",
  "post_install": [
    "$sourceFilePath = \"$env:USERPROFILE\\scoop\\apps\\locale-emulator\\current\\LEProc.exe\"",
    "$chineseName = \"11月的理想乡\"",
    "$name = \"11gatsu\"",
    "$shortcutPath1 = \"${env:APPDATA}\\Microsoft\\Windows\\Start Menu\\Programs\\Scoop Apps\\$chineseName.lnk\"",
    "$shortcutPath2 = \"${env:APPDATA}\\Microsoft\\Windows\\Start Menu\\Programs\\Scoop Apps\\$name.lnk\"",
    "$defaultSaveDir = \"$dir\\UserData\"",
    "$exe = \"11Gatsu_cn.exe\"",
    "$arguments = \"-run $dir\\$exe\"",
    "$icon = \"$dir\\$exe, 0\"",
    "$wScriptObj = New-Object -ComObject (\"WScript.Shell\")",
    "$shortcut = $wScriptObj.CreateShortcut($shortcutPath1)",
    "$shortcut.TargetPath = $sourceFilePath",
    "$shortcut.Arguments = $arguments",
    "$shortcut.WorkingDirectory = \"$dir\";",
    "$shortcut.WindowStyle = 1;",
    "$shortcut.IconLocation = $icon",
    "$shortcut.Save()",
    "Copy-Item \"$shortcutPath1\" -Destination \"$shortcutPath2\"",
    "$conf = \"<?xml version=\"\"1.0\"\" encoding=\"\"utf-8\"\"?>\r\n<LEConfig>\r\n  <Profiles>\r\n    <Profile Name=\"\"$exe.le.config\"\" Guid=\"\"$((New-Guid).Guid)\"\" MainMenu=\"\"false\"\">\r\n      <Parameter></Parameter>\r\n      <Location>zh</Location>\r\n      <Timezone>Tokyo Standard Time</Timezone>\r\n      <RunAsAdmin>false</RunAsAdmin>\r\n      <RedirectRegistry>true</RedirectRegistry>\r\n      <IsAdvancedRedirection>false</IsAdvancedRedirection>\r\n      <RunWithSuspend>false</RunWithSuspend>\r\n    </Profile>\r\n  </Profiles>\r\n</LEConfig>\"",
    "$galSave = if ($env:GalSave) { $env:GalSave } else { \"$env:USERPROFILE\\GalSave\" }",
    "$conf | Out-File -Encoding UTF8 \"$dir\\$exe.le.config\"",
    "mkdir $galSave\\$name >$null 2>$null",
    "if (Test-Path -Path $defaultSaveDir) { rm -force $defaultSaveDir\\* }",
    "New-Item -ItemType Junction -Path $defaultSaveDir -Target $galSave\\$name >$null"
  ],
  "depends": "extras/locale-emulator",
  "uninstaller": {
    "script": [
      "$chineseName = \"11月的理想乡\"",
      "$name = \"11gatsu\"",
      "$shortcutPath1 = \"${env:APPDATA}\\Microsoft\\Windows\\Start Menu\\Programs\\Scoop Apps\\$chineseName.lnk\"",
      "$shortcutPath2 = \"${env:APPDATA}\\Microsoft\\Windows\\Start Menu\\Programs\\Scoop Apps\\$name.lnk\"",
      "Remove-Item -Path \"$shortcutPath1\"",
      "Remove-Item -Path \"$shortcutPath2\""
    ]
  }
}
