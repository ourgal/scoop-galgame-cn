{
  "version": "0.1.0",
  "description": "由梦想与色彩编织而成",
  "url": "https://zd.shinnku.top/file/shinnku/0/win/%E7%94%B1%E6%A2%A6%E6%83%B3%E4%B8%8E%E8%89%B2%E5%BD%A9%E7%BC%96%E7%BB%87%E8%80%8C%E6%88%90v1.01.7z",
  "hash": "0475b0f75b6d50a69af2582307b82dc1c332f11c27febe5a83319e4d1f42831a",
  "extract_dir": "由梦想与色彩编织而成v1.01",
  "post_install": [
    "$sourceFilePath = \"$env:USERPROFILE\\scoop\\apps\\locale-emulator\\current\\LEProc.exe\"",
    "$chineseName = \"由梦想与色彩编织而成\"",
    "$name = \"yumeiro\"",
    "$shortcutPath1 = \"${env:APPDATA}\\Microsoft\\Windows\\Start Menu\\Programs\\Scoop Apps\\$chineseName.lnk\"",
    "$shortcutPath2 = \"${env:APPDATA}\\Microsoft\\Windows\\Start Menu\\Programs\\Scoop Apps\\$name.lnk\"",
    "$defaultSaveDir = \"$dir\\save_cn\"",
    "$exe = \"yumeiro_cn.exe\"",
    "$arguments = \"-run $dir\\$exe\"",
    "$icon = \"$dir\\$exe, 0\"",
    "$wScriptObj = New-Object -ComObject (\"WScript.Shell\")",
    "$shortcut = $wScriptObj.CreateShortcut($shortcutPath1)",
    "$shortcut.TargetPath = $sourceFilePath",
    "$shortcut.Arguments = $arguments",
    "$shortcut.WorkingDirectory = \"$dir\";",
    "$shortcut.WindowStyle = 1;",
    "$shortcut.IconLocation = $icon",
    "$shortcut.Save()",
    "Copy-Item \"$shortcutPath1\" -Destination \"$shortcutPath2\"",
    "$conf = \"<?xml version=\"\"1.0\"\" encoding=\"\"utf-8\"\"?>\r\n<LEConfig>\r\n  <Profiles>\r\n    <Profile Name=\"\"$exe.le.config\"\" Guid=\"\"$((New-Guid).Guid)\"\" MainMenu=\"\"false\"\">\r\n      <Parameter></Parameter>\r\n      <Location>zh</Location>\r\n      <Timezone>Tokyo Standard Time</Timezone>\r\n      <RunAsAdmin>false</RunAsAdmin>\r\n      <RedirectRegistry>true</RedirectRegistry>\r\n      <IsAdvancedRedirection>false</IsAdvancedRedirection>\r\n      <RunWithSuspend>false</RunWithSuspend>\r\n    </Profile>\r\n  </Profiles>\r\n</LEConfig>\"",
    "$galSave = if ($env:GalSave) { $env:GalSave } else { \"$env:USERPROFILE\\GalSave\" }",
    "$conf | Out-File -Encoding UTF8 \"$dir\\$exe.le.config\"",
    "mkdir $galSave\\$name >$null 2>$null",
    "if (Test-Path -Path $defaultSaveDir) { rm -force $defaultSaveDir\\* }",
    "New-Item -ItemType Junction -Path $defaultSaveDir -Target $galSave\\$name >$null"
  ],
  "depends": "extras/locale-emulator",
  "uninstaller": {
    "script": [
      "$chineseName = \"由梦想与色彩编织而成\"",
      "$name = \"yumeiro\"",
      "$shortcutPath1 = \"${env:APPDATA}\\Microsoft\\Windows\\Start Menu\\Programs\\Scoop Apps\\$chineseName.lnk\"",
      "$shortcutPath2 = \"${env:APPDATA}\\Microsoft\\Windows\\Start Menu\\Programs\\Scoop Apps\\$name.lnk\"",
      "Remove-Item -Path \"$shortcutPath1\"",
      "Remove-Item -Path \"$shortcutPath2\""
    ]
  }
}
