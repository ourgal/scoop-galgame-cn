{
  "version": "0.1.0",
  "description": "不要践踏天使的羽毛",
  "url": "https://zd.shinnku.top/file/shinnku/0/win/%E4%B8%8D%E8%A6%81%E8%B7%B5%E8%B8%8F%E5%A4%A9%E4%BD%BF%E7%9A%84%E7%BE%BD%E6%AF%9B.7z",
  "hash": "d35705c6ea11cf01d90d4b8a0815a5d1e7124251eb46a7b3d6bb71c4290ba826",
  "extract_dir": "不要践踏天使的羽毛",
  "post_install": [
    "$sourceFilePath = \"$env:USERPROFILE\\scoop\\apps\\locale-emulator\\current\\LEProc.exe\"",
    "$chineseName = \"不要践踏天使的羽毛\"",
    "$name = \"afeather\"",
    "$shortcutPath1 = \"${env:APPDATA}\\Microsoft\\Windows\\Start Menu\\Programs\\Scoop Apps\\$chineseName.lnk\"",
    "$shortcutPath2 = \"${env:APPDATA}\\Microsoft\\Windows\\Start Menu\\Programs\\Scoop Apps\\$name.lnk\"",
    "$defaultSaveDir = \"$dir\\savedata\"",
    "$exe = \"AFeather_CN_V0.99.exe\"",
    "$arguments = \"-run $dir\\$exe\"",
    "$icon = \"$dir\\$exe, 0\"",
    "$wScriptObj = New-Object -ComObject (\"WScript.Shell\")",
    "$shortcut = $wScriptObj.CreateShortcut($shortcutPath1)",
    "$shortcut.TargetPath = $sourceFilePath",
    "$shortcut.Arguments = $arguments",
    "$shortcut.WorkingDirectory = \"$dir\";",
    "$shortcut.WindowStyle = 1;",
    "$shortcut.IconLocation = $icon",
    "$shortcut.Save()",
    "Copy-Item \"$shortcutPath1\" -Destination \"$shortcutPath2\"",
    "$conf = \"<?xml version=\"\"1.0\"\" encoding=\"\"utf-8\"\"?>\r\n<LEConfig>\r\n  <Profiles>\r\n    <Profile Name=\"\"$exe.le.config\"\" Guid=\"\"$((New-Guid).Guid)\"\" MainMenu=\"\"false\"\">\r\n      <Parameter></Parameter>\r\n      <Location>zh</Location>\r\n      <Timezone>Tokyo Standard Time</Timezone>\r\n      <RunAsAdmin>false</RunAsAdmin>\r\n      <RedirectRegistry>true</RedirectRegistry>\r\n      <IsAdvancedRedirection>false</IsAdvancedRedirection>\r\n      <RunWithSuspend>false</RunWithSuspend>\r\n    </Profile>\r\n  </Profiles>\r\n</LEConfig>\"",
    "$galSave = if ($env:GalSave) { $env:GalSave } else { \"$env:USERPROFILE\\GalSave\" }",
    "$conf | Out-File -Encoding UTF8 \"$dir\\$exe.le.config\"",
    "mkdir $galSave\\$name >$null 2>$null",
    "if (Test-Path -Path $defaultSaveDir) { rm -force $defaultSaveDir\\* }",
    "New-Item -ItemType Junction -Path $defaultSaveDir -Target $galSave\\$name >$null"
  ],
  "depends": "extras/locale-emulator",
  "uninstaller": {
    "script": [
      "$chineseName = \"不要践踏天使的羽毛\"",
      "$name = \"afeather\"",
      "$shortcutPath1 = \"${env:APPDATA}\\Microsoft\\Windows\\Start Menu\\Programs\\Scoop Apps\\$chineseName.lnk\"",
      "$shortcutPath2 = \"${env:APPDATA}\\Microsoft\\Windows\\Start Menu\\Programs\\Scoop Apps\\$name.lnk\"",
      "Remove-Item -Path \"$shortcutPath1\"",
      "Remove-Item -Path \"$shortcutPath2\""
    ]
  }
}
